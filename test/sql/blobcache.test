# name: test/sql/blobcache.test
# description: test blobcache extension
# group: [sql]

load __TEST_DIR__/blobtest.db

require blobcache

require parquet

# connection main
statement ok
install tpch

statement ok
load tpch

statement ok
call dbgen(sf=0.3);

statement ok
copy lineitem to 'lineitem.parquet';

statement ok
call enable_logging(level='error', storage_path = '/tmp/mylog.csv');

statement ok
select max(l_comment) from read_parquet('fakes3://lineitem.parquet');

restart

query I
select message from read_csv('/tmp/mylog.csv')
----
