# name: test/sql/blobcache.test
# description: test blobcache extension
# group: [sql]

require blobcache

require parquet

# connection main
statement ok
install tpch

statement ok
load tpch

statement ok
call dbgen(sf=0.3);

statement ok
copy lineitem to 'lineitem.parquet';

statement ok
copy (select 42 as message where message=0) to 'mylog.csv';

statement ok
call enable_logging(level='error', storage_path = 'mylog2.csv');

query I
select message from read_csv('mylog1.csv', ignore_errors=true)
----

statement ok
select max(l_comment) from read_parquet('fakes3://lineitem.parquet');
